<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAILS Management System - Contracts</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --dark-charcoal: #1a1a1a;
            --medium-grey: #2d2d2d;
            --light-grey: #404040;
            --background-grey: #f5f5f5;
            --pure-white: #ffffff;
            --professional-blue: #0066cc;
            --success-green: #28a745;
            --error-red: #dc3545;
            --warning-amber: #ffc107;
            --border-color: #e0e0e0;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --shadow: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 8px rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background-grey);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--pure-white);
            border-right: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-header h1 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .sidebar-header p {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .sidebar-nav {
            padding: 16px 0;
        }

        .nav-group {
            margin-bottom: 24px;
        }

        .nav-group-title {
            padding: 8px 24px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .nav-item {
            display: block;
            padding: 12px 24px;
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }

        .nav-item:hover {
            background: #f8f9fa;
            border-left-color: var(--professional-blue);
        }

        .nav-item.active {
            background: #e3f2fd;
            border-left-color: var(--professional-blue);
            color: var(--professional-blue);
        }

        .nav-item i {
            width: 20px;
            margin-right: 12px;
            font-size: 16px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 24px;
        }

        /* Header */
        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            background: var(--pure-white);
            padding: 20px 24px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .header-title h2 {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .header-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* Buttons */
        .btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--pure-white);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--professional-blue);
            color: white;
            border-color: var(--professional-blue);
        }

        .btn-success {
            background: var(--success-green);
            color: white;
            border-color: var(--success-green);
        }

        .btn-danger {
            background: var(--error-red);
            color: white;
            border-color: var(--error-red);
        }

        .btn-warning {
            background: var(--warning-amber);
            color: white;
            border-color: var(--warning-amber);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* Cards */
        .card {
            background: var(--pure-white);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Tabs */
        .tabs-container {
            margin-bottom: 24px;
        }

        .tabs-nav {
            display: flex;
            background: var(--pure-white);
            border-radius: 12px;
            padding: 8px;
            box-shadow: var(--shadow);
            gap: 4px;
        }

        .tab-button {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .tab-button.active {
            background: var(--professional-blue);
            color: white;
            box-shadow: var(--shadow);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Contract Filters */
        .contract-filters {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 24px;
            padding: 20px;
            background: var(--pure-white);
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-control {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            min-width: 120px;
        }

        .search-input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            min-width: 250px;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            background: var(--pure-white);
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: #f8f9fa;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border-color);
        }

        .table td {
            padding: 16px 12px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        /* Contract Cards */
        .contracts-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .contract-card {
            background: var(--pure-white);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }

        .contract-card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        .contract-card.status-active {
            border-left-color: var(--success-green);
        }

        .contract-card.status-draft {
            border-left-color: var(--text-secondary);
        }

        .contract-card.status-completed {
            border-left-color: var(--professional-blue);
        }

        .contract-card.status-terminated {
            border-left-color: var(--error-red);
        }

        .contract-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .contract-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .contract-number {
            font-size: 12px;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .contract-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .meta-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .meta-value {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        .contract-progress {
            margin-bottom: 16px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .progress-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .progress-percentage {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .progress {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--professional-blue);
            transition: width 0.3s ease;
        }

        .progress-bar.success {
            background: var(--success-green);
        }

        .progress-bar.warning {
            background: var(--warning-amber);
        }

        .progress-bar.danger {
            background: var(--error-red);
        }

        .contract-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* Status Badges */
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }

        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .badge-secondary {
            background: #e2e3e5;
            color: #383d41;
        }

        .badge-primary {
            background: #b3d9ff;
            color: #0056b3;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 5vh;
        }

        .modal-content {
            background: var(--pure-white);
            border-radius: 12px;
            padding: 24px;
            width: 100%;
            max-width: 900px;
            box-shadow: var(--shadow-hover);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--professional-blue);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--pure-white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .stat-number {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Payment Schedule */
        .payment-schedule {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .payment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .payment-item:last-child {
            border-bottom: none;
        }

        .payment-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .payment-description {
            font-weight: 500;
            font-size: 14px;
        }

        .payment-date {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .payment-amount {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 24px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -18px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--professional-blue);
            border: 3px solid var(--pure-white);
            box-shadow: 0 0 0 2px var(--professional-blue);
        }

        .timeline-date {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .timeline-content {
            background: var(--pure-white);
            padding: 12px;
            border-radius: 6px;
            box-shadow: var(--shadow);
        }

        .timeline-title {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .timeline-description {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 16px;
            }

            .contract-filters {
                flex-direction: column;
                gap: 12px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .tabs-nav {
                flex-direction: column;
                gap: 2px;
            }

            .contracts-list {
                grid-template-columns: 1fr;
            }

            .contract-meta {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>SAILS</h1>
                <p>Management System</p>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <div class="nav-group-title">Main</div>
                    <a href="#" class="nav-item" onclick="navigateTo('dashboard')">
                        <i class="fas fa-tachometer-alt"></i>
                        Dashboard
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Project Management</div>
                    <a href="#" class="nav-item" onclick="navigateTo('activities')">
                        <i class="fas fa-tasks"></i>
                        Activities
                    </a>
                    <a href="#" class="nav-item" onclick="navigateTo('deliverables')">
                        <i class="fas fa-check-circle"></i>
                        Deliverables
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Procurement & Contracts</div>
                    <a href="#" class="nav-item" onclick="navigateTo('procurements')">
                        <i class="fas fa-shopping-cart"></i>
                        Procurements
                    </a>
                    <a href="#" class="nav-item active">
                        <i class="fas fa-file-contract"></i>
                        Contracts
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Resources</div>
                    <a href="#" class="nav-item" onclick="navigateTo('assets')">
                        <i class="fas fa-cubes"></i>
                        Assets
                    </a>
                    <a href="#" class="nav-item" onclick="navigateTo('finances')">
                        <i class="fas fa-dollar-sign"></i>
                        Finances
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Analytics</div>
                    <a href="#" class="nav-item" onclick="navigateTo('reports')">
                        <i class="fas fa-chart-bar"></i>
                        Reports
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">System</div>
                    <a href="#" class="nav-item" onclick="navigateTo('settings')">
                        <i class="fas fa-cog"></i>
                        Settings
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="main-header">
                <div class="header-title">
                    <h2>Contract Management</h2>
                    <div class="header-subtitle">Manage contract lifecycle, payments, and performance</div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openContractModal()">
                        <i class="fas fa-plus"></i>
                        New Contract
                    </button>
                    <button class="btn" onclick="exportContracts()">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                </div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalContracts">12</div>
                    <div class="stat-label">Total Contracts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activeContracts">8</div>
                    <div class="stat-label">Active Contracts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalValue">$1.8M</div>
                    <div class="stat-label">Total Value</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingPayments">5</div>
                    <div class="stat-label">Pending Payments</div>
                </div>
            </div>

            <!-- Tabs Container -->
            <div class="tabs-container">
                <div class="tabs-nav">
                    <button class="tab-button active" onclick="switchTab('contracts')">
                        <i class="fas fa-file-contract"></i>
                        Contracts
                    </button>
                    <button class="tab-button" onclick="switchTab('payments')">
                        <i class="fas fa-credit-card"></i>
                        Payments
                    </button>
                    <button class="tab-button" onclick="switchTab('amendments')">
                        <i class="fas fa-edit"></i>
                        Amendments
                    </button>
                    <button class="tab-button" onclick="switchTab('performance')">
                        <i class="fas fa-chart-line"></i>
                        Performance
                    </button>
                </div>

                <!-- Contracts Tab -->
                <div class="tab-content active" id="contracts-tab">
                    <!-- Contract Filters -->
                    <div class="contract-filters">
                        <div class="filter-group">
                            <label class="filter-label">Search</label>
                            <input type="text" class="search-input" placeholder="Search contracts..." id="contractSearch" oninput="filterContracts()">
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Status</label>
                            <select class="filter-control" id="statusFilter" onchange="filterContracts()">
                                <option value="">All Statuses</option>
                                <option value="draft">Draft</option>
                                <option value="active">Active</option>
                                <option value="suspended">Suspended</option>
                                <option value="completed">Completed</option>
                                <option value="terminated">Terminated</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Type</label>
                            <select class="filter-control" id="typeFilter" onchange="filterContracts()">
                                <option value="">All Types</option>
                                <option value="consulting">Consulting</option>
                                <option value="goods">Goods</option>
                                <option value="works">Works</option>
                                <option value="training">Training</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Contract Type</label>
                            <select class="filter-control" id="contractTypeFilter" onchange="filterContracts()">
                                <option value="">All Contract Types</option>
                                <option value="fixed_price">Fixed Price</option>
                                <option value="cost_plus">Cost Plus</option>
                                <option value="time_materials">Time & Materials</option>
                            </select>
                        </div>
                    </div>

                    <!-- Contracts List -->
                    <div class="contracts-list" id="contractsList">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Payments Tab -->
                <div class="tab-content" id="payments-tab">
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Payment #</th>
                                    <th>Contract</th>
                                    <th>Milestone</th>
                                    <th>Amount</th>
                                    <th>Due Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Amendments Tab -->
                <div class="tab-content" id="amendments-tab">
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Amendment #</th>
                                    <th>Contract</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Value Change</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="amendmentsTableBody">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Performance Tab -->
                <div class="tab-content" id="performance-tab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Contract Performance Dashboard</h3>
                            <select class="filter-control" id="performanceContractFilter" onchange="updatePerformanceView()">
                                <option value="">All Contracts</option>
                            </select>
                        </div>
                        <div id="performanceContent">
                            <!-- Performance metrics will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Contract Modal -->
    <div class="modal" id="contractModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="contractModalTitle">New Contract</h3>
                <button class="modal-close" onclick="closeContractModal()">&times;</button>
            </div>
            
            <form id="contractForm">
                <div class="form-group">
                    <label class="form-label">Contract Number</label>
                    <input type="text" class="form-control" id="contractNumber" placeholder="AUTO-GENERATED" readonly>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Contract Title</label>
                        <input type="text" class="form-control" id="contractTitle" placeholder="Contract title" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-control" id="contractCategory" required>
                            <option value="">Select Category</option>
                            <option value="consulting">Consulting Services</option>
                            <option value="goods">Goods</option>
                            <option value="works">Works</option>
                            <option value="training">Training</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Contractor Name</label>
                        <input type="text" class="form-control" id="contractorName" placeholder="Contractor company name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Contract Type</label>
                        <select class="form-control" id="contractType" required>
                            <option value="">Select Type</option>
                            <option value="fixed_price">Fixed Price</option>
                            <option value="cost_plus">Cost Plus</option>
                            <option value="time_materials">Time & Materials</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group full-width">
                    <label class="form-label">Contract Description</label>
                    <textarea class="form-control" id="contractDescription" rows="3" placeholder="Detailed description of contract scope"></textarea>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Contract Value (USD)</label>
                        <input type="number" class="form-control" id="contractValue" placeholder="0.00" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Currency</label>
                        <select class="form-control" id="contractCurrency">
                            <option value="USD">USD - US Dollar</option>
                            <option value="MVR">MVR - Maldivian Rufiyaa</option>
                            <option value="EUR">EUR - Euro</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-control" id="contractStartDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-control" id="contractEndDate" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Contract Manager</label>
                        <select class="form-control" id="contractManager">
                            <option value="">Select Manager</option>
                            <option value="manager_1">Jailam Mohe</option>
                            <option value="manager_2">Sarah Johnson</option>
                            <option value="manager_3">Ahmed Hassan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Related Procurement</label>
                        <select class="form-control" id="relatedProcurement">
                            <option value="">Select Procurement</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn" onclick="closeContractModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Contract</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Application State
        let contracts = [];
        let payments = [];
        let amendments = [];
        let currentTab = 'contracts';
        let editingContract = null;

        // In-Memory Storage
        const inMemoryStorage = {};

        // Sample Data
        const sampleContracts = [
            {
                id: 'contract_001',
                contractNumber: 'SAILS-CNT-2025-001',
                title: 'IT Equipment Supply and Installation',
                description: 'Supply and installation of computers, servers, and network equipment for SAILS project',
                contractor: {
                    name: 'TechSolutions Maldives',
                    contact: 'contact@techsolutions.mv',
                    address: 'Male, Maldives'
                },
                contractType: 'fixed_price',
                category: 'goods',
                value: 150000,
                currency: 'USD',
                startDate: '2025-06-01',
                endDate: '2025-12-31',
                status: 'active',
                progress: 65,
                contractManager: 'manager_1',
                managerName: 'Jailam Mohe',
                relatedProcurement: 'proc_001',
                paymentTerms: 'Net 30 days',
                performance: {
                    deliverables: 8,
                    completed: 5,
                    onTime: 4,
                    rating: 4.2
                },
                createdAt: '2025-05-15',
                updatedAt: '2025-05-28'
            },
            {
                id: 'contract_002',
                contractNumber: 'SAILS-CNT-2025-002',
                title: 'Digital Skills Training Program',
                description: 'Comprehensive training program for digital literacy and skills development',
                contractor: {
                    name: 'Education Partners Ltd',
                    contact: 'info@edupartners.mv',
                    address: 'Hulhumale, Maldives'
                },
                contractType: 'time_materials',
                category: 'training',
                value: 85000,
                currency: 'USD',
                startDate: '2025-07-01',
                endDate: '2025-12-31',
                status: 'active',
                progress: 25,
                contractManager: 'manager_2',
                managerName: 'Sarah Johnson',
                relatedProcurement: 'proc_002',
                paymentTerms: 'Monthly milestones',
                performance: {
                    deliverables: 12,
                    completed: 3,
                    onTime: 3,
                    rating: 4.5
                },
                createdAt: '2025-06-20',
                updatedAt: '2025-05-25'
            },
            {
                id: 'contract_003',
                contractNumber: 'SAILS-CNT-2025-003',
                title: 'Office Renovation and Upgrading',
                description: 'Complete renovation of project office facilities including furniture and fixtures',
                contractor: {
                    name: 'Construction Co. Maldives',
                    contact: 'projects@construction.mv',
                    address: 'Vilimale, Maldives'
                },
                contractType: 'fixed_price',
                category: 'works',
                value: 45000,
                currency: 'USD',
                startDate: '2025-08-01',
                endDate: '2025-10-31',
                status: 'draft',
                progress: 0,
                contractManager: 'manager_3',
                managerName: 'Ahmed Hassan',
                relatedProcurement: 'proc_003',
                paymentTerms: 'Progress payments',
                performance: {
                    deliverables: 6,
                    completed: 0,
                    onTime: 0,
                    rating: 0
                },
                createdAt: '2025-05-01',
                updatedAt: '2025-05-01'
            }
        ];

        const samplePayments = [
            {
                id: 'payment_001',
                paymentNumber: 'PAY-2025-001',
                contractId: 'contract_001',
                contractTitle: 'IT Equipment Supply and Installation',
                milestone: 'Equipment Delivery',
                amount: 75000,
                dueDate: '2025-07-15',
                status: 'pending',
                description: 'Payment for delivered equipment as per contract milestone 1'
            },
            {
                id: 'payment_002',
                paymentNumber: 'PAY-2025-002',
                contractId: 'contract_002',
                contractTitle: 'Digital Skills Training Program',
                milestone: 'Month 1 Training',
                amount: 14000,
                dueDate: '2025-07-31',
                status: 'approved',
                description: 'Monthly payment for training services completed in July'
            },
            {
                id: 'payment_003',
                paymentNumber: 'PAY-2025-003',
                contractId: 'contract_001',
                contractTitle: 'IT Equipment Supply and Installation',
                milestone: 'Installation Complete',
                amount: 75000,
                dueDate: '2025-09-30',
                status: 'scheduled',
                description: 'Final payment upon complete installation and testing'
            }
        ];

        const sampleAmendments = [
            {
                id: 'amendment_001',
                amendmentNumber: 'AMD-2025-001',
                contractId: 'contract_001',
                contractTitle: 'IT Equipment Supply and Installation',
                type: 'scope_change',
                description: 'Added additional network security equipment',
                valueChange: 15000,
                effectiveDate: '2025-06-15',
                status: 'approved',
                reason: 'Additional security requirements identified'
            },
            {
                id: 'amendment_002',
                amendmentNumber: 'AMD-2025-002',
                contractId: 'contract_002',
                contractTitle: 'Digital Skills Training Program',
                type: 'time_extension',
                description: 'Extended contract by 2 months',
                valueChange: 0,
                effectiveDate: '2025-07-01',
                status: 'pending',
                reason: 'Delay in participant recruitment'
            }
        ];

        // Initialize Application
        function initializeApp() {
            // Load data from memory storage or use sample data
            contracts = inMemoryStorage['sails_contracts'] ? 
                JSON.parse(inMemoryStorage['sails_contracts']) : sampleContracts;
            payments = inMemoryStorage['sails_payments'] ? 
                JSON.parse(inMemoryStorage['sails_payments']) : samplePayments;
            amendments = inMemoryStorage['sails_amendments'] ? 
                JSON.parse(inMemoryStorage['sails_amendments']) : sampleAmendments;

            // Render initial data
            updateStats();
            renderCurrentTab();
            setupEventListeners();
            populateDropdowns();

            // Show welcome message
            setTimeout(() => {
                showNotification('Contract management module loaded successfully', 'success');
            }, 500);
        }

        // Tab Management
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Render tab content
            renderCurrentTab();
        }

        function renderCurrentTab() {
            switch (currentTab) {
                case 'contracts':
                    renderContracts();
                    break;
                case 'payments':
                    renderPayments();
                    break;
                case 'amendments':
                    renderAmendments();
                    break;
                case 'performance':
                    renderPerformance();
                    break;
            }
        }

        // Render Functions
        function renderContracts() {
            const container = document.getElementById('contractsList');
            const filteredContracts = filterContractsData();
            
            container.innerHTML = '';
            
            if (filteredContracts.length === 0) {
                container.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px; grid-column: 1 / -1;">
                        <i class="fas fa-search" style="font-size: 48px; color: var(--text-secondary); margin-bottom: 16px;"></i>
                        <h3 style="margin-bottom: 8px;">No contracts found</h3>
                        <p style="color: var(--text-secondary);">Try adjusting your search criteria or create a new contract.</p>
                    </div>
                `;
                return;
            }
            
            filteredContracts.forEach(contract => {
                const contractCard = createContractCard(contract);
                container.appendChild(contractCard);
            });
        }

        function createContractCard(contract) {
            const card = document.createElement('div');
            card.className = `contract-card status-${contract.status}`;
            card.innerHTML = `
                <div class="contract-header">
                    <div>
                        <div class="contract-title">${contract.title}</div>
                        <div class="contract-number">${contract.contractNumber}</div>
                    </div>
                    <span class="badge badge-${getContractStatusClass(contract.status)}">${formatStatus(contract.status)}</span>
                </div>
                
                <div class="contract-meta">
                    <div class="meta-item">
                        <div class="meta-label">Contractor</div>
                        <div class="meta-value">${contract.contractor.name}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Value</div>
                        <div class="meta-value">$${contract.value.toLocaleString()}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Start Date</div>
                        <div class="meta-value">${formatDate(contract.startDate)}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">End Date</div>
                        <div class="meta-value">${formatDate(contract.endDate)}</div>
                    </div>
                </div>
                
                <div class="contract-progress">
                    <div class="progress-header">
                        <span class="progress-label">Contract Progress</span>
                        <span class="progress-percentage">${contract.progress}%</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar ${getProgressBarClass(contract.progress)}" style="width: ${contract.progress}%"></div>
                    </div>
                </div>
                
                <div class="contract-actions">
                    <button class="btn btn-sm" onclick="editContract('${contract.id}')" title="Edit Contract">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-sm btn-success" onclick="viewContractDetails('${contract.id}')" title="View Details">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-warning" onclick="createAmendment('${contract.id}')" title="Create Amendment">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="btn btn-sm btn-primary" onclick="managePayments('${contract.id}')" title="Manage Payments">
                        <i class="fas fa-credit-card"></i>
                    </button>
                </div>
            `;
            
            return card;
        }

        function renderPayments() {
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';
            
            payments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${payment.paymentNumber}</strong></td>
                    <td>${payment.contractTitle}</td>
                    <td>${payment.milestone}</td>
                    <td><strong>$${payment.amount.toLocaleString()}</strong></td>
                    <td>${formatDate(payment.dueDate)}</td>
                    <td><span class="badge badge-${getPaymentStatusClass(payment.status)}">${formatStatus(payment.status)}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="viewPayment('${payment.id}')" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-success" onclick="processPayment('${payment.id}')" title="Process Payment">
                            <i class="fas fa-check"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function renderAmendments() {
            const tbody = document.getElementById('amendmentsTableBody');
            tbody.innerHTML = '';
            
            amendments.forEach(amendment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${amendment.amendmentNumber}</strong></td>
                    <td>${amendment.contractTitle}</td>
                    <td><span class="badge badge-info">${formatAmendmentType(amendment.type)}</span></td>
                    <td>${amendment.description}</td>
                    <td><strong>${amendment.valueChange > 0 ? '+' : ''}$${amendment.valueChange.toLocaleString()}</strong></td>
                    <td>${formatDate(amendment.effectiveDate)}</td>
                    <td><span class="badge badge-${getAmendmentStatusClass(amendment.status)}">${formatStatus(amendment.status)}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="viewAmendment('${amendment.id}')" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-success" onclick="approveAmendment('${amendment.id}')" title="Approve">
                            <i class="fas fa-check"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function renderPerformance() {
            const container = document.getElementById('performanceContent');
            const selectedContract = document.getElementById('performanceContractFilter').value;
            
            if (!selectedContract) {
                // Show overall performance metrics
                container.innerHTML = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">${calculateOverallPerformance().avgCompletion}%</div>
                            <div class="stat-label">Average Completion</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${calculateOverallPerformance().onTimeRate}%</div>
                            <div class="stat-label">On-Time Delivery Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${calculateOverallPerformance().avgRating}</div>
                            <div class="stat-label">Average Rating</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${calculateOverallPerformance().totalDeliverables}</div>
                            <div class="stat-label">Total Deliverables</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h4>Contract Performance Overview</h4>
                        </div>
                        <div style="padding: 20px; color: var(--text-secondary); text-align: center;">
                            <i class="fas fa-chart-line" style="font-size: 48px; margin-bottom: 16px;"></i>
                            <p>Select a contract to view detailed performance metrics</p>
                        </div>
                    </div>
                `;
            } else {
                const contract = contracts.find(c => c.id === selectedContract);
                if (contract) {
                    renderContractPerformance(contract, container);
                }
            }
        }

        function renderContractPerformance(contract, container) {
            container.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${contract.progress}%</div>
                        <div class="stat-label">Overall Progress</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${contract.performance.completed}/${contract.performance.deliverables}</div>
                        <div class="stat-label">Deliverables</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${Math.round((contract.performance.onTime / contract.performance.completed) * 100) || 0}%</div>
                        <div class="stat-label">On-Time Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${contract.performance.rating}</div>
                        <div class="stat-label">Performance Rating</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Payment Schedule</h4>
                        </div>
                        <div class="payment-schedule">
                            ${renderPaymentSchedule(contract.id)}
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h4>Contract Timeline</h4>
                        </div>
                        <div class="timeline">
                            ${renderContractTimeline(contract)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPaymentSchedule(contractId) {
            const contractPayments = payments.filter(p => p.contractId === contractId);
            if (contractPayments.length === 0) {
                return '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No payments scheduled</p>';
            }
            
            return contractPayments.map(payment => `
                <div class="payment-item">
                    <div class="payment-info">
                        <div class="payment-description">${payment.milestone}</div>
                        <div class="payment-date">Due: ${formatDate(payment.dueDate)}</div>
                    </div>
                    <div>
                        <div class="payment-amount">$${payment.amount.toLocaleString()}</div>
                        <span class="badge badge-${getPaymentStatusClass(payment.status)}">${formatStatus(payment.status)}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderContractTimeline(contract) {
            const timeline = [
                {
                    date: contract.createdAt,
                    title: 'Contract Created',
                    description: 'Contract drafted and initial terms defined'
                },
                {
                    date: contract.startDate,
                    title: 'Contract Started',
                    description: 'Contract execution began'
                }
            ];
            
            // Add amendments to timeline
            const contractAmendments = amendments.filter(a => a.contractId === contract.id);
            contractAmendments.forEach(amendment => {
                timeline.push({
                    date: amendment.effectiveDate,
                    title: 'Amendment ' + amendment.amendmentNumber,
                    description: amendment.description
                });
            });
            
            // Add end date if not completed
            if (contract.status !== 'completed') {
                timeline.push({
                    date: contract.endDate,
                    title: 'Scheduled Completion',
                    description: 'Contract scheduled to end'
                });
            }
            
            // Sort by date
            timeline.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            return timeline.map(item => `
                <div class="timeline-item">
                    <div class="timeline-date">${formatDate(item.date)}</div>
                    <div class="timeline-content">
                        <div class="timeline-title">${item.title}</div>
                        <div class="timeline-description">${item.description}</div>
                    </div>
                </div>
            `).join('');
        }

        // Filter Functions
        function filterContracts() {
            renderContracts();
        }

        function filterContractsData() {
            const search = document.getElementById('contractSearch')?.value.toLowerCase() || '';
            const status = document.getElementById('statusFilter')?.value || '';
            const type = document.getElementById('typeFilter')?.value || '';
            const contractType = document.getElementById('contractTypeFilter')?.value || '';

            return contracts.filter(contract => {
                const matchesSearch = !search || 
                    contract.title.toLowerCase().includes(search) ||
                    contract.contractNumber.toLowerCase().includes(search) ||
                    contract.contractor.name.toLowerCase().includes(search);
                
                const matchesStatus = !status || contract.status === status;
                const matchesType = !type || contract.category === type;
                const matchesContractType = !contractType || contract.contractType === contractType;
                
                return matchesSearch && matchesStatus && matchesType && matchesContractType;
            });
        }

        // Modal Functions
        function openContractModal(contractId = null) {
            editingContract = contractId;
            const modal = document.getElementById('contractModal');
            const form = document.getElementById('contractForm');
            
            if (contractId) {
                const contract = contracts.find(c => c.id === contractId);
                if (contract) {
                    document.getElementById('contractModalTitle').textContent = 'Edit Contract';
                    populateContractForm(contract);
                }
            } else {
                document.getElementById('contractModalTitle').textContent = 'New Contract';
                form.reset();
                generateContractNumber();
            }
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeContractModal() {
            const modal = document.getElementById('contractModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            editingContract = null;
        }

        function populateContractForm(contract) {
            document.getElementById('contractNumber').value = contract.contractNumber;
            document.getElementById('contractTitle').value = contract.title;
            document.getElementById('contractDescription').value = contract.description;
            document.getElementById('contractCategory').value = contract.category;
            document.getElementById('contractorName').value = contract.contractor.name;
            document.getElementById('contractType').value = contract.contractType;
            document.getElementById('contractValue').value = contract.value;
            document.getElementById('contractCurrency').value = contract.currency;
            document.getElementById('contractStartDate').value = contract.startDate;
            document.getElementById('contractEndDate').value = contract.endDate;
            document.getElementById('contractManager').value = contract.contractManager;
            document.getElementById('relatedProcurement').value = contract.relatedProcurement;
        }

        function generateContractNumber() {
            const year = new Date().getFullYear();
            const count = contracts.length + 1;
            const number = `SAILS-CNT-${year}-${count.toString().padStart(3, '0')}`;
            document.getElementById('contractNumber').value = number;
        }

        function populateDropdowns() {
            // Populate performance contract filter
            const performanceSelect = document.getElementById('performanceContractFilter');
            performanceSelect.innerHTML = '<option value="">All Contracts</option>';
            
            contracts.forEach(contract => {
                const option = document.createElement('option');
                option.value = contract.id;
                option.textContent = contract.contractNumber + ' - ' + contract.title;
                performanceSelect.appendChild(option);
            });
        }

        // CRUD Operations
        function editContract(contractId) {
            openContractModal(contractId);
        }

        function deleteContract(contractId) {
            if (confirm('Are you sure you want to delete this contract?')) {
                contracts = contracts.filter(c => c.id !== contractId);
                saveContracts();
                renderContracts();
                updateStats();
                showNotification('Contract deleted successfully', 'success');
            }
        }

        function saveContract(contractData) {
            if (editingContract) {
                const index = contracts.findIndex(c => c.id === editingContract);
                if (index !== -1) {
                    contracts[index] = { ...contracts[index], ...contractData, updatedAt: new Date().toISOString() };
                    showNotification('Contract updated successfully', 'success');
                }
            } else {
                const newContract = {
                    id: 'contract_' + Date.now(),
                    ...contractData,
                    status: 'draft',
                    progress: 0,
                    performance: {
                        deliverables: 0,
                        completed: 0,
                        onTime: 0,
                        rating: 0
                    },
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                contracts.push(newContract);
                showNotification('Contract created successfully', 'success');
            }
            
            saveContracts();
            renderContracts();
            updateStats();
            populateDropdowns();
            closeContractModal();
        }

        function saveContracts() {
            inMemoryStorage['sails_contracts'] = JSON.stringify(contracts);
        }

        // Event Listeners
        function setupEventListeners() {
            const form = document.getElementById('contractForm');
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    contractNumber: document.getElementById('contractNumber').value,
                    title: document.getElementById('contractTitle').value,
                    description: document.getElementById('contractDescription').value,
                    category: document.getElementById('contractCategory').value,
                    contractor: {
                        name: document.getElementById('contractorName').value,
                        contact: '',
                        address: ''
                    },
                    contractType: document.getElementById('contractType').value,
                    value: parseFloat(document.getElementById('contractValue').value) || 0,
                    currency: document.getElementById('contractCurrency').value,
                    startDate: document.getElementById('contractStartDate').value,
                    endDate: document.getElementById('contractEndDate').value,
                    contractManager: document.getElementById('contractManager').value,
                    managerName: getManagerName(document.getElementById('contractManager').value),
                    relatedProcurement: document.getElementById('relatedProcurement').value,
                    paymentTerms: 'Net 30 days'
                };
                
                if (validateContractForm(formData)) {
                    saveContract(formData);
                }
            });
            
            // Close modal when clicking outside
            document.getElementById('contractModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeContractModal();
                }
            });
        }

        function validateContractForm(data) {
            const errors = [];
            
            if (!data.title) errors.push('Title is required');
            if (!data.category) errors.push('Category is required');
            if (!data.contractor.name) errors.push('Contractor name is required');
            if (!data.contractType) errors.push('Contract type is required');
            if (!data.value || data.value <= 0) errors.push('Valid contract value is required');
            if (!data.startDate) errors.push('Start date is required');
            if (!data.endDate) errors.push('End date is required');
            
            if (data.startDate && data.endDate && new Date(data.startDate) >= new Date(data.endDate)) {
                errors.push('End date must be after start date');
            }
            
            if (errors.length > 0) {
                showNotification('Please fix the following errors: ' + errors.join(', '), 'error');
                return false;
            }
            
            return true;
        }

        // Stats Update
        function updateStats() {
            document.getElementById('totalContracts').textContent = contracts.length;
            document.getElementById('activeContracts').textContent = contracts.filter(c => c.status === 'active').length;
            
            const totalValue = contracts.reduce((sum, c) => sum + c.value, 0);
            document.getElementById('totalValue').textContent = '$' + (totalValue / 1000000).toFixed(1) + 'M';
            
            document.getElementById('pendingPayments').textContent = payments.filter(p => p.status === 'pending').length;
        }

        function updatePerformanceView() {
            renderPerformance();
        }

        // Performance Calculations
        function calculateOverallPerformance() {
            const activeContracts = contracts.filter(c => c.status === 'active' || c.status === 'completed');
            
            if (activeContracts.length === 0) {
                return {
                    avgCompletion: 0,
                    onTimeRate: 0,
                    avgRating: 0,
                    totalDeliverables: 0
                };
            }
            
            const avgCompletion = Math.round(activeContracts.reduce((sum, c) => sum + c.progress, 0) / activeContracts.length);
            const totalDeliverables = activeContracts.reduce((sum, c) => sum + c.performance.deliverables, 0);
            const totalCompleted = activeContracts.reduce((sum, c) => sum + c.performance.completed, 0);
            const totalOnTime = activeContracts.reduce((sum, c) => sum + c.performance.onTime, 0);
            
            const onTimeRate = totalCompleted > 0 ? Math.round((totalOnTime / totalCompleted) * 100) : 0;
            const avgRating = (activeContracts.reduce((sum, c) => sum + c.performance.rating, 0) / activeContracts.length).toFixed(1);
            
            return {
                avgCompletion,
                onTimeRate,
                avgRating,
                totalDeliverables
            };
        }

        // Export Function
        function exportContracts() {
            const exportData = {
                contracts: contracts,
                payments: payments,
                amendments: amendments,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'sails_contracts_export.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('Contract data exported successfully', 'success');
        }

        // Utility Functions
        function formatStatus(status) {
            return status.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        }

        function formatAmendmentType(type) {
            const typeMap = {
                'scope_change': 'Scope Change',
                'time_extension': 'Time Extension',
                'value_change': 'Value Change',
                'terms_modification': 'Terms Modification'
            };
            return typeMap[type] || type;
        }

        function getContractStatusClass(status) {
            const statusMap = {
                'draft': 'secondary',
                'active': 'success',
                'suspended': 'warning',
                'completed': 'primary',
                'terminated': 'danger'
            };
            return statusMap[status] || 'secondary';
        }

        function getPaymentStatusClass(status) {
            const statusMap = {
                'pending': 'warning',
                'approved': 'success',
                'paid': 'primary',
                'scheduled': 'info',
                'overdue': 'danger'
            };
            return statusMap[status] || 'secondary';
        }

        function getAmendmentStatusClass(status) {
            const statusMap = {
                'pending': 'warning',
                'approved': 'success',
                'rejected': 'danger',
                'draft': 'secondary'
            };
            return statusMap[status] || 'secondary';
        }

        function getProgressBarClass(progress) {
            if (progress >= 100) return 'success';
            if (progress >= 75) return '';
            if (progress >= 50) return 'warning';
            return 'danger';
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function getManagerName(managerId) {
            const managerMap = {
                'manager_1': 'Jailam Mohe',
                'manager_2': 'Sarah Johnson',
                'manager_3': 'Ahmed Hassan'
            };
            return managerMap[managerId] || '';
        }

        // Navigation
        function navigateTo(module) {
            showNotification(`Navigating to ${module}...`, 'info');
        }

        // Placeholder functions for future implementation
        function viewContractDetails(contractId) {
            showNotification('Contract details view would open here', 'info');
        }

        function createAmendment(contractId) {
            showNotification('Amendment creation form would open here', 'info');
        }

        function managePayments(contractId) {
            showNotification('Payment management interface would open here', 'info');
        }

        function viewPayment(paymentId) {
            showNotification('Payment details would open here', 'info');
        }

        function processPayment(paymentId) {
            showNotification('Payment processing interface would open here', 'info');
        }

        function viewAmendment(amendmentId) {
            showNotification('Amendment details would open here', 'info');
        }

        function approveAmendment(amendmentId) {
            if (confirm('Are you sure you want to approve this amendment?')) {
                const amendment = amendments.find(a => a.id === amendmentId);
                if (amendment) {
                    amendment.status = 'approved';
                    renderAmendments();
                    showNotification('Amendment approved successfully', 'success');
                }
            }
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success-green)' : 
                            type === 'error' ? 'var(--error-red)' : 
                            type === 'warning' ? 'var(--warning-amber)' : 'var(--professional-blue)'};
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: var(--shadow-hover);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize the application
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>